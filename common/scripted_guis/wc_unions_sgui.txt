opening_union_window = {
	scope = character

	is_valid = {
		custom_tooltip = {
			text = any_union_exist_gui
			has_global_variable_list = all_unions
		}
	}
	effect = {
		hidden_effect = {
			if = {
				limit = {
					has_global_variable_list = all_unions
				}
				if = {
					limit = { has_variable = this_union }
					random_in_global_list = {
						variable = all_unions
						limit = { var:this_union = prev.var:this_union }
						save_temporary_scope_as = this_union
					}
				}
				else = {
					ordered_in_global_list = {
						variable = all_unions
						position = 0
						save_temporary_scope_as = this_union
					}
				}
				
				get_this_union_variables_effect = yes
				set_variable = { name = gui_union value = scope:this_union }
				set_variable = { name = gui_this_union_name value = scope:this_union.var:this_union }
			}
			else = {
				set_variable = { name = gui_this_union_name value = flag:empty_union }
				if = { limit = { always = no var:gui_this_union_name = flag:empty_union } }
			}
		}
	}
}
preselected_union_sgui = {
	scope = character

	saved_scopes = {
		chosen_union
	}

	effect = {
		set_variable = {
			name = pre_chosen_union
			value = scope:chosen_union
		}
	}
}
save_union_sgui = {
	scope = character
	saved_scopes = {
		union_flag
	}

	effect = {
		random_in_global_list = {
			variable = all_unions
			limit = {
				var:this_union = scope:union_flag
			}
			save_temporary_scope_as = this_union
		}
		get_this_union_variables_effect = yes
		set_variable = { name = gui_union value = scope:this_union }
		set_variable = { name = gui_this_union_name value = scope:this_union.var:this_union }
		remove_variable = pre_chosen_union
	}
}

clear_gui_union_variables = {
	scope = character

	effect = {
		clear_this_union_variables_effect = yes
	}
}

open_union_rename = {
	scope = character
	saved_scopes = {
		union_flag
	}

	is_shown = {
		has_global_variable_list = all_unions
		any_in_global_list = {
			variable = all_unions
			var:this_union = scope:union_flag
			story_owner = prev
		}
	}
	is_valid = {
		NOT = { has_variable = gui_union_rename_open }
	}
	effect = {
		set_variable = { name = gui_union_rename_open value = flag:true }
		trigger_event = WCPLF.330
	}
}
invest_fund_gold = {
	scope = character
	saved_scopes = {
		my_candidate
	}

	is_valid = {
		gold >= 100
	}
	effect = {
		remove_short_term_gold = 100
		scope:my_candidate = {
			if = {
				limit = { has_variable = campaign_fund }
				change_variable = { name = campaign_fund add = 200 }
			}
			else = { set_variable = { name = campaign_fund value = 200 } }
		}
	}
}
invest_fund_prestige = {
	scope = character
	saved_scopes = {
		my_candidate
	}

	is_valid = {
		prestige >= 100
	}
	effect = {
		add_prestige = -100
		scope:my_candidate = {
			if = {
				limit = { has_variable = campaign_fund }
				change_variable = { name = campaign_fund add = 200 }
			}
			else = { set_variable = { name = campaign_fund value = 200 } }
		}
	}
}